<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Harmonic Matrix</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-size: 16px;
            overflow: hidden;
            color: #fff
        }

        #GUI {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 300px;
            z-index: 10;
            background-color: #111;
            border: 3px solid #555;
            padding: 10px;
            border-radius: 20px;
        }

        input {
            text-align: center;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid #ccc;

            background-color: #eee;
            color: #000;
        }
        h3 {
            margin: 10px 0 5px 0;
        }

        input[readonly] {
            background-color: #aaa;
            color: #333;
        }

        details {
            font-size: 14px;
            margin-left: 10px;
        }
    </style>
</head>

<body>
    <canvas id="canvas"></canvas>
    <div id="GUI">
        <div style="text-align: center;">
            <input type="text" id="baseNote" value="A4" pattern="^[A-G][0-8]$" style="width:3em;"> ＝
            <input type="text" inputmode="numeric" class="integer" id="baseFreq" value="440" style="width:3em;"> Hz<br>
        </div>
        <h3>音律</h3>
        <div style="display: grid; grid-template-columns: 30px auto;">
            <span>
                <input type="radio" name="tuning" id="justIntonation">
            </span>
            <span>
                純正律
            </span>
            <span>
                <input type="radio" name="tuning" id="fromP" checked>
            </span>
            <span>
                P ＝ <input type="text" inputmode="numeric" class="integer" id="PVal" value="2" style="width:10em;">
            </span>
            <span>
                <input type="radio" name="tuning" id="fromQ">
            </span>
            <span>
                Q ＝ <input type="text" inputmode="numeric" class="integer" id="QVal" value="0" style="width:10em;" readonly>
            </span>
            <span>
                <input type="radio" name="tuning" id="fromS">
            </span>
            <span>
                S ＝ <input type="text" inputmode="numeric" class="integer" id="SVal" value="0" style="width:10em;" readonly>
            </span>
            <span></span>
            <span>
                log P ： log Q ＝
                <input type="text" inputmode="numeric" class="integer" id="pVal" value="12" style="width:2em;"> ：
                <input type="text" inputmode="numeric" class="integer" id="qVal" value="19" style="width:2em;">
            </span>
        </div>
        <span style="font-size: small;"><input type="checkbox" id="autopq" checked> 自動で整数比を調整<br></span>
        <details>
            <summary>説明</summary>
            各音階は、2を近似するPと3を近似するQをもとに、基準の周波数をP<sup>n</sup>×Q<sup>m</sup>倍することで作られます。<br>
            純正律の場合、PとQを直接指定します。この場合、step数は表示されません。<br>
            それ以外では、S = P<sup>1/p</sup>, Q = P<sup>1/q</sup>となるように、P,R,Sのうち1つを入力すると残り二つが定まります。<br>
            「自動で整数比を調整」をオンにすると、log Pかlog Qの片方を入力したときにlog P：log Q≒log 2：log 3となるように、もう片方が自動的に変更されます。
        </details>

        <h3>モード</h3>
        <input type="radio" name="playMode" id="playModeHold" checked> ホールド
        <input type="radio" name="playMode" id="playModeToggle"> トグル<br>
        <!--
        <div style="display: grid; gap:5px 20px; grid-template-columns: auto auto;">
            <input type="radio" name="playMode" id="playModeHold" checked> <span>ホールド</span>
            <input type="radio" name="playMode" id="playModeToggle"> <span>トグル</span>
        </div>
        -->

        <h3>変形</h3>
            ［<input type="text" inputmode="numeric" class="integer" id="matrix1A" value="2" style="width:2em;">
            <input type="text" inputmode="numeric" class="integer" id="matrix1B" value="-1" style="width:2em;">〉 →
            (<input type="text" inputmode="numeric" class="decimal" id="matrix2A" value="0" style="width:2em;">
            <input type="text" inputmode="numeric" class="decimal" id="matrix2B" value="-1" style="width:2em;">) <br>
            ［<input type="text" inputmode="numeric" class="integer" id="matrix1C" value="-1" style="width:2em;">
            <input type="text" inputmode="numeric" class="integer" id="matrix1D" value="1" style="width:2em;">〉 →
            (<input type="text" inputmode="numeric" class="decimal" id="matrix2C" value="1" style="width:2em;">
            <input type="text" inputmode="numeric" class="decimal" id="matrix2D" value="-1" style="width:2em;">) <br>
            <!--            <input type="checkbox" id="matrixNormalize">行列式で正規化<br> -->

        <h3>表示</h3>
        <div style="display: grid; gap:5px 20px; grid-template-columns: auto auto;">
            <span style="text-align: center; grid-area: 1 / 1 / 2 / 3;">
                <input type="text" id="minNote" value="A1" style="width:2em;">　～　
                <input type="text" id="maxNote" value="A7" style="width:2em;">
            </span>
            <span style="text-align: right;">
                <input type="text" inputmode="numeric" class="integer" id="flatNum" value="2" style="width:2em;">
            </span>
            <span>フラット</span>
            <span style="text-align: right;">
                <input type="text" inputmode="numeric" class="integer" id="sharpNum" value="2" style="width:2em;">
            </span>
            <span>シャープ</span>
        </div>
        <div style="display: grid; gap:5px 20px; grid-template-columns: auto auto;">
            <span style="text-align: right;">スケール</span><input type="range" id="scale" min="40" max="200" value="100"
                style="width:200px;">
            <span style="text-align: right;">間隔</span><input type="range" id="gap" min="40" max="200" value="100"
                style="width:200px;">
        </div>
        <input type="checkbox" id="showSteps"> ステップ数を表示<br>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/p5/lib/p5.min.js"></script>
    <script src="./main.js"></script>
</body>

</html>